<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>meemoo/iframework @ GitHub -- iframework proof-of-concept</title>
  
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
  
  <script src="lib/underscore-min.js"></script>
  <script src="lib/backbone-min.js"></script>
  
  <script src="iframework.js"></script>
  
  <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/smoothness/jquery-ui.css" rel="stylesheet" type="text/css" />
  
  <link href="iframework.css" rel="stylesheet" type="text/css" />
  
</head>
<body>
  
  <footer>
    meemoo iframework by <a href="http://forresto.com/">forrest oliphant</a><br />
    <a href="https://github.com/meemoo/iframework">view source</a> on github<br />
    examples: <span id="examples"></span>
  </footer>
  
  <script type="text/template" id="graph-template">
  
    <div class="graph">
      <div class="edges" />
      <div class="nodes" />
    </div>
    <div class="panel">
      <button class="button source">source</button>
      <div class="code">
        <button class="button close">close</button><br />
        <textarea class="sourceedit" /><br />
        <button class="button apply" title="reloads the app">apply changes</button>
      </div>
    </div>
  
  </script>
  
  <script type="text/template" id="node-template">
    
    <div class="module" style="left:<%= x-10 %>px;top:<%= y-30 %>px;width:<%= w+20 %>px;height:<%= h+40 %>px;" >
      <div class="ports ports-in"></div>
      <div class="ports ports-out"></div>
      <h1 class="title">...</h1>
      <iframe class="frame" src="<%= src %>#nodeid=<%= id %>" style="width:<%= w %>px;height:<%= h %>px;"></iframe>
    </div>
    
  </script>
  
  <script type="text/template" id="port-in-template">
  
    <div class="port port-in port-<%= name %>" title="<%= name %> (<%= type %>)">
      <span class="hole hole-in hole-<%= name %>"> </span>
      <span class="label"><%= name %></span>
      <span class="widget"></span>
    </div>
  
  </script>
  
  <script type="text/template" id="port-out-template">
  
    <div class="port port-out port-<%= name %>" title="<%= name %> (<%= type %>)">
      <span class="label"><%= name %></span>
      <span class="hole hole-out hole-<%= name %>"></span>
    </div>
    
  </script>
  
  <script type="text/template" id="edge-template">
  
    <svg class="wire" xmlns="http://www.w3.org/2000/svg" version="1.1" style="position:absolute;left:<%= svgX() %>px;top:<%= svgY() %>px;width:<%= svgW() %>px;height:<%= svgH() %>px;">
      <path class="wire-shadow" d="<%= svgPathShadow() %>" stroke="#AAA" />
      <path class="wire" d="<%= svgPath() %>" stroke="<%= color() %>" />
    </svg>
    
  </script>

  <script type="text/template" id="edge-edit-template">
    
    <div class="edge-edit-item" id="<%= model.cid %>">
      <span><%= label() %></span>
      <!-- <input class="color" value="<%= color() %>" /> -->
      <button class="disconnect">disconnect</button>
    </div>
    
  </script>
  
  <script type="text/javascript">
  
  $(document).ready(function(){
    
    var exampleGraphs = [
    {
      "info": {
        "title": "cam to gif",
        "author": "forresto",
        "description": "webcam to animated gif",
        "url": "cam2gif"
      },
      "nodes": [
        {
          "src": "http://forresto.github.com/meemoo-camcanvas/webcam2jpg.html",
          "x": 129,
          "y": 45,
          "w": 339,
          "h": 283,
          "id": 1,
          "state": {
            "quality": 75,
            "width": 320,
            "height": 240
          }
        },
        {
          "src": "http://forresto.github.com/meemoo-modules/img2canvas.html",
          "x": 616,
          "y": 45,
          "w": 333,
          "h": 264,
          "id": 2
        },
        {
          "src": "http://forresto.github.com/meemoo-canvas2gif/canvas2gif.html",
          "x": 127,
          "y": 415,
          "w": 357,
          "h": 285,
          "id": 3,
          "state": {
            "delay": 200,
            "quality": 75
          }
        },
        {
          "src": "http://forresto.github.com/meemoo-modules/imgur.html",
          "x": 629,
          "y": 412,
          "w": 357,
          "h": 297,
          "id": 5,
          "state": {
            "title": "meemoo/cam2gif image share",
            "caption": "This image was created with a Meemoo composition. http://meemoo.org/iframework/#/example/cam2gif"
          }
        }
      ],
      "edges": [
        {
          "source": [
            1,
            "jpg"
          ],
          "target": [
            2,
            "dataurl"
          ],
          "color": "#DF151A"
        },
        {
          "source": [
            2,
            "image"
          ],
          "target": [
            3,
            "image"
          ],
          "color": "#FD8603"
        },
        {
          "source": [
            3,
            "gif"
          ],
          "target": [
            5,
            "dataurl"
          ],
          "color": "#F4F328"
        }
      ]
    },
    {
      "info": {
        "title": "cam to glitch",
        "author": "forresto",
        "description": "webcam to jpg to glitch",
        "url": "cam"
      },
      "nodes": [
        {
          "src": "http://forresto.github.com/meemoo-modules/metronome.html",
          "x": 139,
          "y": 45,
          "w": 200,
          "h": 100,
          "id": 1,
          "state": {
            "bpm": 150
          }
        },
        {
          "src": "http://forresto.github.com/meemoo-camcanvas/webcam2jpg.html",
          "x": 581,
          "y": 49,
          "w": 339,
          "h": 283,
          "id": 2,
          "state": {
            "quality": 50,
            "width": 320,
            "height": 240
          }
        },
        {
          "src": "http://forresto.github.com/meemoo-jpgglitch/index.html",
          "x": 138,
          "y": 220,
          "w": 339,
          "h": 262,
          "id": 4
        },
        {
          "src": "http://forresto.github.com/meemoo-modules/img2canvas.html",
          "x": 282,
          "y": 559,
          "w": 116,
          "h": 98,
          "id": 5
        },
        {
          "src": "http://forresto.github.com/meemoo-modules/reflow.html",
          "x": 646,
          "y": 398,
          "w": 256,
          "h": 297,
          "id": 3
        }
      ],
      "edges": [
        {
          "source": [
            1,
            "beat"
          ],
          "target": [
            2,
            "capture"
          ],
          "color": "#DF151A"
        },
        {
          "source": [
            2,
            "jpg"
          ],
          "target": [
            4,
            "jpg"
          ],
          "color": "#FD8603"
        },
        {
          "source": [
            5,
            "image"
          ],
          "target": [
            3,
            "image"
          ],
          "color": "#F4F328"
        },
        {
          "source": [
            4,
            "jpg"
          ],
          "target": [
            5,
            "dataurl"
          ],
          "color": "#00DA3C"
        }
      ]
    },
    {
      info: {
        title: "processing dot js",
        author: "forresto",
        description: "processing to reflow",
        url: "processing"
      },
      nodes: [
        {
          id: 1,
          src: "http://forresto.github.com/meemoo-modules/metronome.html", 
          "x":130,"y":47,"w":230,"h":110, 
          state: { bpm: 140, start: true }
        },
        {
          id: 3,
          src: "http://forresto.github.com/meemoo-modules/processing.html", 
          "x":148,"y":246,"w":308,"h":308,
          state: { 
            processingcode: "void setup() { size(300, 300); colorMode(HSB, 360, 100, 300); noStroke(); background(0); } \n void mousePressed () { fill(random(360), 180, 300); triangle(random(width), random(height), 100, 100, 200, 200);}" 
          }
        },
        {
          id: 4,
          src: "http://forresto.github.com/meemoo-modules/reflow.html", 
          "x":630,"y":88,"w":449,"h":199
        },
        {
          id: 5,
          src: "http://forresto.github.com/meemoo-modules/reflow.html", 
          "x":686,"y":384,"w":440,"h":204
        }
        //,
        // {
        //   id: 6,
        //   src: "http://jsrun.it/forresto/meemoo-module-test",
        //   "x":521,"y":50,"w":300,"h":160,
        //   state: { txt: "loaded this module from jsdo.it, then set it with this message with the graph data" }
        // }
      ],
      edges: [
        { source: [1, "beat"],  target: [3, "pressed"] },
        { source: [3, "image"], target: [4, "image"] }
      ]
    }
    ];
    
    MeemooApplication.showGraph(exampleGraphs[0]);
    
    
    
    
    var MeemooRouter = Backbone.Router.extend({

      routes: {
        "/example/:url": "loadExample",    // #/example/url
      },

      loadExample: function(url) {
        for (var i=0; i<exampleGraphs.length; i++) {
          if (exampleGraphs[i]["info"]["url"] === url) {
            MeemooApplication.showGraph(exampleGraphs[i]);
            document.title = "meemoo/"+url;
            return;
          }
        }
      }

    });
    MeemooApplication.router = new MeemooRouter();
    Backbone.history.start();
    
    // Make example links:
    for (var i=0; i<exampleGraphs.length; i++) {
      var url = exampleGraphs[i]["info"]["url"];
      if (url) {
        $("#examples").append('<a href="#/example/'+url+'" title="'+exampleGraphs[i]["info"]["description"]+'">'+url+'</a> ')
      }
    }
    
  
  });
  
  </script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-274009-19']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  
</body>
</html>